<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 18 â€“ Deepika â¤ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;1,700&family=Poppins:wght@300;500;700&family=Caveat:wght@700&family=Dancing+Script:wght@700&family=Noto+Sans+Devanagari:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #ff4e50; --accent: #ffd700; --purple-bg: #1a0033; --neon: #00ffcc; --parchment: #fdf5e6; }
        body { margin: 0; padding: 0; min-height: 100vh; background: linear-gradient(135deg, #ff9a9e, #fad0c4, #fbc2eb, #a18cd1); background-size: 400% 400%; animation: romanticBG 12s ease infinite; font-family: 'Poppins', sans-serif; text-align: center; color: white; overflow-x: hidden; }
        @keyframes romanticBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .hidden { display: none !important; }
        .full-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; padding: 20px; box-sizing: border-box; }
        
        /* Audio & Entry */
        #audioOverlay { background: rgba(0,0,0,0.95); z-index: 20000; cursor: pointer; }
        .glow { text-shadow: 0 0 10px #fff, 0 0 20px var(--primary); animation: pulse 2s infinite alternate; }
        @keyframes pulse { from { text-shadow: 0 0 10px #fff; } to { text-shadow: 0 0 30px var(--primary); } }

        /* General UI */
        .btn { background: white; color: var(--primary); border: none; padding: 15px 35px; border-radius: 50px; font-weight: bold; cursor: pointer; margin: 10px; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.3); font-family: 'Poppins'; z-index: 10; }
        .btn:hover { transform: scale(1.1); background: #fff0f0; box-shadow: 0 0 20px var(--neon); }
        input { padding: 15px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.5); text-align: center; font-family: 'Poppins'; outline: none; width: 280px; margin: 15px; background: rgba(255,255,255,0.9); color: #333; font-weight: bold; }

        /* Lock Screen */
        #dateGate { background: radial-gradient(circle, #2c3e50 0%, #000000 100%); }
        #countdownTimer { font-size: 4em; font-family: 'Playfair Display'; color: var(--accent); margin: 20px 0; }

        /* Slideshow */
        #slideshowContainer { background: radial-gradient(circle, #430000 0%, #000000 100%); z-index: 11000; }
        .slide-img { max-width: 85%; max-height: 65vh; border-radius: 20px; border: 5px solid white; box-shadow: 0 0 40px rgba(255,78,80,0.4); }
        .caption { margin-top: 30px; font-size: 2.2em; font-family: 'Caveat', cursive; color: var(--accent); text-shadow: 2px 2px 8px rgba(0,0,0,0.8); }

        /* Final Page Main */
        #mainContent { background: linear-gradient(to bottom, #1a0033, #2d004d, #000b1a); }
        .message-box { background: rgba(0,0,0,0.5); backdrop-filter: blur(15px); padding: 35px; border-radius: 25px; max-width: 650px; border: 1px solid var(--neon); line-height: 1.8; font-size: 1.15em; z-index: 2; position: relative; }

        /* Sidebar Wall of Love */
        #loveSidebar { position: fixed; width: 100px; height: 100px; z-index: 1001; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .love-icon { font-size: 50px; filter: drop-shadow(0 0 15px var(--neon)); transition: 0.3s; }
        #lovePop { background: rgba(10, 0, 20, 0.98); z-index: 5000; overflow-y: auto; padding: 80px 20px; }
        .nickname { font-family: 'Dancing Script', cursive; font-size: 2.2em; color: var(--accent); margin: 10px; display: inline-block; animation: fadeIn 0.8s forwards; opacity: 0; }

        /* Verses Parchment */
        #versesModal { background: rgba(0,0,0,0.9); z-index: 7000; }
        .parchment-card { background: var(--parchment); color: #332211; padding: 40px; border-radius: 5px; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: inset 0 0 50px rgba(0,0,0,0.2), 0 20px 40px rgba(0,0,0,0.5); font-family: 'Playfair Display', serif; line-height: 1.8; position: relative; border: 1px solid #d4af37; text-align: left; }
        .hindi-text { font-family: 'Noto Sans Devanagari', serif; font-size: 1.3em; line-height: 2; color: #441111; font-weight: 700; }

        /* D&K Geographic Animation */
        .dk-stage { position: relative; width: 350px; height: 450px; display: flex; justify-content: center; align-items: center; }
        .dk-logo-final { font-size: 4.5em; font-family: 'Playfair Display'; color: var(--accent); opacity: 0; text-shadow: 0 0 30px var(--accent); z-index: 5; }
        .anim-line { position: absolute; background: var(--neon); box-shadow: 0 0 10px var(--neon); transition: 1s linear; }
        .location-tag { position: absolute; font-family: 'Caveat'; font-size: 1.8em; color: white; opacity: 0; transition: 0.5s; }
        .meeting-point { position: absolute; bottom: 20px; font-weight: bold; font-size: 2.5em; color: var(--accent); opacity: 0; text-shadow: 0 0 20px var(--accent); }

        /* Particles */
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.5; animation: crash 2s linear infinite; }
        @keyframes crash { 0% { transform: translateY(-10vh); opacity: 1; } 100% { transform: translateY(110vh); opacity: 0; } }
        .balloon { position: fixed; bottom: -120px; width: 60px; height: 85px; border-radius: 50% 50% 50% 50% / 45% 45% 55% 55%; z-index: 999; animation: floatUp 7s ease-in forwards; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-130vh); opacity: 0; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <audio id="quizMusic" loop><source src="quiz.m4a" type="audio/mpeg"></audio>
    <audio id="memoriesMusic" loop><source src="memories.mp3" type="audio/mpeg"></audio>
    <audio id="finalMusic" loop><source src="final.mp3" type="audio/mpeg"></audio>

    <div id="audioOverlay" class="full-screen" onclick="startExperience()">
        <h1 class="glow" style="font-family: 'Playfair Display'; font-size: 3.5em;">Chapter 18 â¤ï¸</h1>
        <p style="font-size: 1.2em; letter-spacing: 1px;">Click to enter Deepika's World</p>
        <button class="btn">Start Magic âœ¨</button>
    </div>

    <div id="dateGate" class="full-screen hidden">
        <h2 class="glow" style="font-family: 'Playfair Display';">Good things take time, My Love... â³</h2>
        <div id="countdownTimer">00:00:00</div>
        <button id="lockBtn" class="btn" onclick="patienceCheck()">Enter The World â”</button>
        <button id="proceedToCipher" class="btn hidden" onclick="showCipher()">Unlock My Memories â”</button>
    </div>

    <div id="welcomeScreen" class="full-screen hidden">
        <h1 class="glow" style="font-family: 'Playfair Display'; margin-bottom: 20px;">For My Kaajukatli â¤ï¸</h1>
        <div class="cipher-box">
            <h3 style="color: var(--accent); font-family: 'Poppins';">ğŸ”“ The Chapter 18 Cipher</h3>
            <p style="letter-spacing: 4px; border: 2px dashed #fff; padding: 20px; font-size: 1.5em; background: rgba(0,0,0,0.2); border-radius: 15px; color: var(--accent);">
                23-8-15 &nbsp; 9-19 &nbsp; 25-15-21-18 <br> 19-15-21-12-13-1-20-5 ?
            </p>
            <input type="text" id="cipherInput" placeholder="ENTER DECODED NAME...">
            <br><button class="btn" onclick="checkCipher()">Verify & Unlock âœ¨</button>
        </div>
    </div>

    <div id="successScreen" class="full-screen hidden">
        <h1 class="glow" style="font-size: 4em; font-family: 'Playfair Display';">Correct! âœ…</h1>
        <p style="font-family: 'Caveat'; font-size: 1.8em; color: var(--accent);">Welcome to your 18th Chapter. â¤ï¸âœ¨</p>
    </div>

    <div id="categoryMenu" class="full-screen hidden">
        <h2 class="glow" style="font-family: 'Playfair Display'; font-size: 2.5em; margin-bottom: 40px;">Choose a Storyline âœ¨</h2>
        <button class="btn" onclick="startSection(1)">âœ¨ The Classic Beauty</button>
        <button class="btn" onclick="toggleLock()">ğŸ˜œ Little Miss Dramebaaz</button>
        <button class="btn" onclick="startSection(3)">ğŸ‘©â€â¤ï¸â€ğŸ‘¨ The Soulmate Saga</button>
        <div id="funnyLock" class="hidden">
            <input type="password" id="funnyPass" placeholder="Secret Access Code...">
            <br><button class="btn" onclick="checkFunnyPass()">Unlock Folder ğŸ”“</button>
        </div>
    </div>

    <div id="slideshowContainer" class="full-screen hidden">
        <img id="currentSlideImg" class="slide-img" src="">
        <div id="currentCaption" class="caption"></div>
        <button class="btn" onclick="nextSlide()" style="margin-top: 30px;">Next Memory â”</button>
    </div>

    <div id="navPopup" class="full-screen hidden" style="background: rgba(0,0,0,0.95);">
        <h2 class="glow" style="font-family: 'Playfair Display';">Where to next, Deepika? âœ¨</h2>
        <div id="popupOptions"></div>
    </div>

    <div id="mainContent" class="full-screen hidden">
        <div id="starsContainer"></div>
        <div id="loveSidebar" onclick="toggleLovePop()">
            <div class="love-icon">ğŸ’–</div>
            <p style="font-size: 0.6em; font-weight: bold; color: var(--neon); text-align: center;">VERSES FOR YOU</p>
        </div>

        <h1 style="font-family: 'Dancing Script', cursive; font-size: 3.5em; color: var(--accent);">Happy Birthday Kaajukatli! ğŸ‚</h1>
        <div class="message-box"><span id="typing"></span></div>
        <button id="versesBtn" class="btn hidden" onclick="openVerses()">Read My Verses ğŸ“œ</button>
    </div>

    <div id="versesModal" class="full-screen hidden">
        <div class="parchment-card">
            <div id="poemContent"></div>
            <hr style="border: 0; border-top: 1px solid #d4af37; margin: 20px 0;">
            <button id="poemActionBtn" class="btn" style="background: #332211; color: #fdf5e6; width: 100%;"></button>
        </div>
    </div>

    <div id="lovePop" class="full-screen hidden" onclick="toggleLovePop()"></div>

    <div id="qPage1" class="full-screen hidden">
        <h2 style="font-family: 'Playfair Display'; font-size: 2.5em; color: white;">How many Birthday's do you wanna celebrate with me? ğŸ¥º</h2>
        <button class="btn" onclick="showQuestion(2)" style="font-size: 2.5em;">âˆ</button>
        <button class="btn" onclick="showQuestion(2)">INFINITE</button>
    </div>

    <div id="qPage2" class="full-screen hidden">
        <h2 style="font-family: 'Playfair Display'; font-size: 2.5em;">Do you really think of me that much? ğŸ§</h2>
        <button class="btn" onclick="startFinalSequence()">YES! â¤ï¸</button>
        <button class="btn" onclick="alert('Khabardar ye option choose kiya toh ğŸ”ª')">NO</button>
    </div>

    <div id="finalLovePage" class="full-screen hidden">
        <div class="dk-stage">
            <div id="dkLogoFinal" class="dk-logo-final">D & K</div>
            <div id="lineL" class="anim-line" style="height:2px; width:0; top:50%; right:50%;"></div>
            <div id="lineR" class="anim-line" style="height:2px; width:0; top:50%; left:50%;"></div>
            <div id="tagB" class="location-tag" style="top:44%; left:0;">Bihar</div>
            <div id="tagM" class="location-tag" style="top:44%; right:0;">Maharashtra</div>
            <div id="lineDL" class="anim-line" style="width:2px; height:0; left:12%; top:50%;"></div>
            <div id="lineDR" class="anim-line" style="width:2px; height:0; right:12%; top:50%;"></div>
            <div id="n16" class="location-tag" style="bottom:20%; left:8%;">16</div>
            <div id="n20" class="location-tag" style="bottom:20%; right:8%;">20</div>
            <div id="lineML" class="anim-line" style="height:2px; width:0; bottom:10%; left:12%;"></div>
            <div id="lineMR" class="anim-line" style="height:2px; width:0; bottom:10%; right:12%;"></div>
            <div id="d21" class="meeting-point">21 Dec</div>
        </div>

        <div id="finalContentArea" class="hidden" style="margin-top: 20px;">
            <h1 class="glow" style="color: var(--neon); font-size: 2.8em;">ILY DEEPIKA! ğŸ˜˜ğŸ’–ğŸ’ğŸ¥°ğŸ’Œ</h1>
            <p id="longWish" style="font-family: 'Playfair Display'; font-size: 1.2em; max-width: 750px; line-height: 1.6; background: rgba(255,255,255,0.05); padding: 25px; border-radius: 20px;"></p>
            <button class="btn glow" onclick="window.open('https://digibouquet.vercel.app/bouquet/3f6e53da-ef6d-4b64-9e1a-389729da7fe7')">Tap for a Surprise ğŸ’</button>
        </div>
    </div>

<script>
    // --- TIMER TOGGLE ---
    const TEST_MODE = true; // SET TO TRUE TO TEST WITH 10 SECONDS

    let currentSectionId = 0, currentIndex = 0, currentPoemIdx = 0;
    let visited = { 1: false, 2: false, 3: false };
    let sidebarMoving = true;
    const quizAud = document.getElementById('quizMusic'), memAud = document.getElementById('memoriesMusic'), finAud = document.getElementById('finalMusic');

    const poems = [
        { title: "Our Journey (Archives) ğŸŒ¸", content: `Bestowed upon a flowerğŸŒ¸, <br>Struck by the fragrance she showersğŸŒ¿.<br>A moment to grasp the metaphorâ€”<br>Her simple smile swirls my heartâ€™s coreâ¤ï¸â€ğŸ”¥.<br>Blooming, my soul becomes ecstaticâœ¨.<br><br>Her gaze whispers romanceğŸ’«,<br>Bringing peace to lifeâ€™s expanseğŸ•Šï¸.<br>Curves flow from neck down to feetğŸ’ƒ,<br>Where every delicacy meets perfection sweetğŸƒ.<br>Darling, your lips, a place to dieğŸ’‹,<br>The ultimate moon with no smudge in the skyğŸŒ™,<br>Filling life with love and gentle restğŸŒ¹.<br><br>The night we shared,<br>By the riverbank sideğŸï¸,<br>Cuddled close on the steps,<br>Warmth growing deep insideğŸ”¥â€”<br>That pace embracing us,<br>Leading to the magical bliss,<br>Caught in the momentâ€™s blushğŸ˜Š,<br>Our first ever kissğŸ’.<br><br>The eyes she holdsğŸ‘€,<br>The cheeks so soft and fair,<br>The curves she gently gotâ€”<br>A dreamy heaven rareğŸŒˆ.<br><br>The magic that the dawn enclosesğŸŒ…,<br>The same magic she lightly sprinklesâœ¨,<br>A tender touch that never closes,<br>Awakening the child within twinklesğŸ‡.<br><br>Every tear in your eyesğŸ˜”<br>Makes my heart acheğŸ’”,<br>A promise that never diesâ€”<br>To keep her happiness awakeğŸŒŸ.<br><br>The moment we shared<br>on the verge of the hillâ›°ï¸,<br>sinking my heart<br>on the instrumental touch<br>realizing how much I have received<br>as I got you with meğŸ’.<br><br>You are my feel-good charmâœ¨,<br>The atmosphere you create<br>Holds something so evidentâ€”<br>The girl for whom I dared<br>To bid adieu to my dream jobğŸ¯,<br>Though I must pursue it still,<br>To make you forever mineğŸ’–.<br><br>You are the most important,<br>I prioritize you alwaysğŸ¥‡,<br>Want you to hold me closeğŸ¤—,<br>Beside a twinkling futureâœ¨,<br>With a torchlight to cherish<br>Our moments in successğŸ†.<br><br>You are my wife already,<br>Living in my heart and mindâ€”<br>Just wait and watch, my love,<br>Our journey yet to unwindğŸ’‘.<br><br>The nonchalant Am I? NahhğŸ˜‰;<br>Feels the velvety softness in every beatğŸ’“,<br>Charm intact as if we both are soul matesğŸ”—.<br><br>Devoted to be a moonlightğŸŒ•,<br>Ending like a sweetheartâ€™s twilight...ğŸŒ…<br><br>Now, a breath, a glance,<br>Where our lips will follow...` },
        { title: "Magical Experience âœ¨", content: `Isnt the nature indicating somethin,<br>Moon seems to be more shiny.<br>Even the beauty lost its weight,<br>Been replaced by the the irreplaceable.<br>Yeah its the name, that I chase for ,<br>Deeply in hearts of optimistic forest,<br>The name of my flower, Deepika.<br><br><hr style="border:1px dashed #d4af37"><br>Dizziness felt<br>And darkness arose<br>Just in time, the tale-lore spoke<br>Enough of the fairy<br>The magic spread thin<br>Just to keep me awake<br>And rooting still <br>For the together self` },
        { title: "à¤µà¥‹ à¤«à¥‚à¤² ğŸŒ¸", content: `<div class="hindi-text">à¤¦à¥à¤¨à¤¿à¤¯à¤¾ à¤°à¤‚à¤—à¥€à¤¨ à¤²à¤—à¥€ à¤¥à¥€ à¤ªà¤¹à¤²à¥‡,<br>à¤ªà¤° à¤¸à¤¬ à¤•à¥à¤› à¤¥à¥‹à¤¡à¤¼à¤¾ à¤«à¥€à¤•à¤¾ à¤¸à¤¾ à¤¨à¤¿à¤•à¤²à¤¾,<br>à¤‰à¤¸à¥€ à¤­à¥€à¤¡à¤¼ à¤®à¥‡à¤‚ à¤•à¤¹à¥€à¤‚<br>à¤®à¥à¤à¥‡ à¤à¤• à¤«à¥‚à¤² à¤¸à¤¾ à¤šà¥‡à¤¹à¤°à¤¾ à¤¦à¤¿à¤–à¤¾à¥¤<br><br>à¤…à¤¬ à¤¬à¤¾à¤¤ à¤¬à¤¸ à¤‰à¤¸à¤•à¥€â€¦<br><br>à¤µà¥‹ à¤«à¥‚à¤²-à¤°à¥‚à¤ªà¥€, à¤•à¥à¤¯à¤¾ à¤•à¤¹à¥‚à¤ à¤‰à¤¸à¥‡,<br>à¤†à¤à¤–à¥‡à¤‚ à¤œà¥ˆà¤¸à¥‡ à¤®à¥‹à¤¤à¥€ à¤­à¥€ à¤¶à¤°à¤®à¤¾ à¤œà¤¾à¤à¤,<br>à¤—à¤¹à¤°à¤¾à¤ˆ à¤à¤¸à¥€ à¤•à¤¿ à¤¦à¥‡à¤–à¥‚à¤ à¤¤à¥‹<br>à¤–à¥à¤¦ à¤•à¥‹ à¤¹à¥€ à¤­à¥‚à¤² à¤œà¤¾à¤Šà¤ à¤•à¤¹à¥€à¤‚à¥¤ ğŸ¤<br><br>à¤‰à¤¸à¤•à¥€ à¤¹à¤à¤¸à¥€â€¦ à¤ªà¥‚à¤°à¥€ à¤¨à¤¹à¥€à¤‚,<br>à¤¥à¥‹à¤¡à¤¼à¥€ à¤¦à¤¿à¤² à¤¸à¥‡, à¤¥à¥‹à¤¡à¤¼à¥€ à¤¸à¥€ à¤§à¥€à¤®à¥€,<br>à¤ªà¤° à¤…à¤œà¥€à¤¬ à¤¸à¤¾ à¤¸à¥à¤•à¥‚à¤¨ à¤¦à¥‡ à¤œà¤¾à¤¤à¥€,<br>à¤œà¥ˆà¤¸à¥‡ à¤¶à¤¾à¤® à¤•à¥€ à¤¹à¤²à¥à¤•à¥€ à¤¸à¥€ à¤¨à¥€à¤²à¥€à¥¤ ğŸŒ™<br><br>à¤¬à¤¾à¤² à¤•à¤­à¥€ à¤¸à¤à¤µà¤°à¥‡, à¤•à¤­à¥€ à¤¬à¤¿à¤–à¤°à¥‡,<br>à¤ªà¤° à¤…à¤šà¥à¤›à¥‡ à¤²à¤—à¤¤à¥‡ à¤µà¥ˆà¤¸à¥‡ à¤¹à¥€,<br>à¤œà¥ˆà¤¸à¥‡ à¤¹à¤µà¤¾ à¤¨à¥‡ à¤›à¥‚à¤•à¤°<br>à¤…à¤ªà¤¨à¤¾ à¤¨à¤¾à¤® à¤²à¤¿à¤– à¤¦à¤¿à¤¯à¤¾ à¤¹à¥‹ à¤µà¤¹à¥€à¤‚à¥¤<br><br>à¤¹à¤¾à¤¥â€¦ à¤œà¤¿à¤¨à¥à¤¹à¥‡à¤‚ à¤ªà¤•à¤¡à¤¼à¤¨à¥‡ à¤•à¤¾ à¤®à¤¨ à¤•à¤°à¥‡,<br>à¤ªà¤° à¤¡à¤° à¤­à¥€ à¤²à¤—à¥‡ à¤œà¤¼à¤°à¤¾,<br>à¤•à¤¿ à¤•à¤¹à¥€à¤‚ à¤¯à¥‡ à¤¸à¤ªà¤¨à¤¾ à¤¨ à¤¹à¥‹<br>à¤¯à¤¾ à¤®à¥ˆà¤‚ à¤¹à¥€ à¤•à¥à¤› à¤œà¤¼à¥à¤¯à¤¾à¤¦à¤¾à¥¤<br><br>à¤µà¥‹ à¤ªà¤°à¤«à¥‡à¤•à¥à¤Ÿ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ à¤¶à¤¾à¤¯à¤¦ à¤¦à¥‚à¤¸à¤°à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤,<br>à¤ªà¤° à¤®à¥à¤à¥‡ à¤¤à¥‹ à¤µà¥ˆà¤¸à¥€ à¤¹à¥€ à¤¸à¤¹à¥€,<br>à¤¥à¥‹à¤¡à¤¼à¥€ à¤¸à¥€ à¤šà¥à¤ª, à¤¥à¥‹à¤¡à¤¼à¥€ à¤¸à¥€ à¤œà¤¿à¤¦à¥à¤¦à¥€,<br>à¤”à¤° à¤¬à¤¾à¤•à¥€ à¤¸à¤¬â€¦ à¤¬à¤¸ à¤µà¤¹à¥€à¥¤ ğŸŒ¸âœ¨</div>` }
    ];


function startExperience() {
    document.getElementById('audioOverlay').classList.add('hidden');
    document.getElementById('dateGate').classList.remove('hidden');
    quizAud.play();

    // FIXED LOGIC: Test Mode now takes absolute priority
    if (TEST_MODE) {
        let t = 10;
        document.getElementById('countdownTimer').innerText = t + "s";
        const iv = setInterval(() => {
            t--; 
            document.getElementById('countdownTimer').innerText = t + "s";
            if(t <= 0){ 
                clearInterval(iv); 
                document.getElementById('lockBtn').classList.add('hidden'); 
                document.getElementById('proceedToCipher').classList.remove('hidden'); 
                document.getElementById('countdownTimer').innerText = "It's Time! â¤ï¸";
            }
        }, 1000);
    } else {
        const target = new Date("February 16, 2026 00:00:00").getTime();
        updateCountdown(target);
    }
}

function updateCountdown(target) {
    const iv = setInterval(() => {
        const diff = target - new Date().getTime();
        if (diff <= 0) { 
            clearInterval(iv);
            document.getElementById('lockBtn').classList.add('hidden'); 
            document.getElementById('proceedToCipher').classList.remove('hidden'); 
            return; 
        }
        const h = Math.floor(diff/(1000*60*60)), 
              m = Math.floor((diff%(1000*60*60))/(1000*60)), 
              s = Math.floor((diff%(1000*60))/1000);
        document.getElementById('countdownTimer').innerText = `${h}h ${m}m ${s}s`;
    }, 1000);
    }

    function patienceCheck() { alert("Good Things Take Time My Love â³â¤ï¸"); }

    function showCipher() {
        document.getElementById('dateGate').classList.add('hidden');
        document.getElementById('welcomeScreen').classList.remove('hidden');
    }

    function checkCipher() {
        if(document.getElementById('cipherInput').value.trim().toUpperCase() === "KARTIK") {
            memAud.play(); quizAud.pause();
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('successScreen').classList.remove('hidden');
            setTimeout(() => { document.getElementById('successScreen').classList.add('hidden'); document.getElementById('categoryMenu').classList.remove('hidden'); }, 2500);
        } else alert("Try again, love! â¤ï¸");
    }

    const sections = {
        1: [{img: "Deepika1.jpg", msg: "Beginning of yours journey ğŸŒ±"}, {img: "Deepika2.jpg", msg: "My favorite smile ğŸ˜ŒğŸ’—"}, {img: "Deepika3.jpg", msg: "Just elegant âœ¨"}, {img: "Deepika4.jpg", msg: "ssshhh.... you are mine ğŸ¤«â¤ï¸"}, {img: "Deepika5.jpg", msg: "Doraemon ğŸ±â€ğŸš€"}, {img: "Deepika6.jpg", msg: "Undoubtedly, you are the most beautiful girl ğŸ‘‘"}],
        2: [{img: "Deepika7.jpg", msg: " Khooyi si  ğŸ”ğŸ’–"}, {img: "Deepika8.jpg", msg: "Kitni khush h yrr - aisi hi reh ğŸ˜ŠğŸ§¿"}, {img: "Deepika9.jpg", msg: "Gehrii sochh.... ğŸ¤”ğŸ’­"}, {img: "Deepika10.jpg", msg: "Chhota Don ğŸ˜ğŸ‘Š"}, {img: "Deepika11.jpg", msg: "In my control now.... chin tapak dum dum ğŸª„ğŸ˜ˆ"}, {img: "Deepika.jpg", msg: "My chubby princess ğŸ˜˜ğŸ’"}],
        3: [{img: "Deepika12.jpg", msg: "Holding you - just a phenomenal experience ğŸ¤ğŸ’"}, {img: "Deepika13.jpg", msg: "Looking into each other - our future ğŸ‘ï¸ğŸŒ…"}, {img: "Deepika14.jpg", msg: "An invisible bluetooth we have ğŸ“¶ğŸ’"}, {img: "Deepika15.jpg", msg: "Just you and me ğŸ‘©â€â¤ï¸â€ğŸ‘¨"}, {img: "Deepika16.jpg", msg: "The deadly duoo ğŸ”¥âš”ï¸"}, {img: "Deepika17.jpg", msg: "Made for each other â™¾ï¸ğŸŒ¹"}]
    };

    function startSection(id) {
        currentSectionId = id; currentIndex = 0; visited[id] = true;
        document.getElementById('categoryMenu').classList.add('hidden');
        document.getElementById('navPopup').classList.add('hidden');
        document.getElementById('slideshowContainer').classList.remove('hidden');
        updateSlide();
    }

    function updateSlide() {
        const d = sections[currentSectionId][currentIndex];
        document.getElementById('currentSlideImg').src = d.img;
        document.getElementById('currentCaption').innerText = d.msg;
    }

    function nextSlide() {
        currentIndex++;
        if(currentIndex < sections[currentSectionId].length) updateSlide();
        else {
            document.getElementById('slideshowContainer').classList.add('hidden');
            const opts = document.getElementById('popupOptions'); opts.innerHTML = "";
            document.getElementById('navPopup').classList.remove('hidden');
            if(!visited[1]) addOpt("âœ¨ Classic Beauty", () => startSection(1), opts);
            if(!visited[2]) addOpt("ğŸ˜œ Dramebaaz", () => { document.getElementById('navPopup').classList.add('hidden'); document.getElementById('categoryMenu').classList.remove('hidden'); toggleLock(); }, opts);
            if(!visited[3]) addOpt("ğŸ‘©â€â¤ï¸â€ğŸ‘¨ Soulmate Saga", () => startSection(3), opts);
            addOpt("ğŸš€ Launch Chapter 18", launchHome, opts);
        }
    }

    function addOpt(t, c, p) { const b = document.createElement('button'); b.className="btn"; b.innerText=t; b.onclick=c; p.appendChild(b); }

    function launchHome() {
        memAud.pause(); finAud.play();
        document.getElementById('navPopup').classList.add('hidden');
        document.getElementById('mainContent').classList.remove('hidden');
        moveSidebar(); createStars(); spawnBalloons();
        let s = "Deepika, stepping into your 18th year... â¤ï¸", i=0;
        function t(){ if(i<s.length){ document.getElementById('typing').innerHTML+=s.charAt(i); i++; setTimeout(t,50); } } t();
    }

    function moveSidebar() {
        if(!sidebarMoving) return;
        const s = document.getElementById('loveSidebar');
        s.style.top = Math.random()*80+10+"%"; s.style.left = Math.random()*80+10+"%";
        s.style.transition = "2s ease";
        setTimeout(moveSidebar, 2000);
    }

    function toggleLovePop() {
        sidebarMoving = false;
        const p = document.getElementById('lovePop');
        if(p.classList.contains('hidden')){
            p.innerHTML = '<h2 style="color:white; font-family:Playfair Display;">My Beautiful...</h2>';
            const nicks = ["Sweetheart", "Doraemon", "Kaajukatli", "Gulab Jamun", "Sweety", "Natkhat", "My Other Half", "My Life", "Cutie pie", "My soul", "My heartbeat", "Raajkumarii", "Meri bachii", "My Moon"];
            nicks.forEach(n => p.innerHTML += `<span class="nickname">${n} â€¢ </span>`);
            p.classList.remove('hidden');
            document.getElementById('versesBtn').classList.remove('hidden');
        } else p.classList.add('hidden');
    }

    function openVerses() { document.getElementById('versesModal').classList.remove('hidden'); showPoem(); }

    function showPoem() {
        const p = poems[currentPoemIdx];
        document.getElementById('poemContent').innerHTML = `<h2 style="text-align:center; color:#441111">${p.title}</h2><div style="max-height:50vh; overflow-y:auto;">${p.content}</div>`;
        const b = document.getElementById('poemActionBtn');
        if(currentPoemIdx < poems.length - 1) {
            b.innerText = "Next Verse â”";
            b.onclick = () => { currentPoemIdx++; showPoem(); document.querySelector('.parchment-card').scrollTop = 0; };
        } else {
            b.innerText = "A Question For You... ğŸ’Œ";
            b.onclick = () => { document.getElementById('versesModal').classList.add('hidden'); showQuestion(1); };
        }
    }

    function showQuestion(n) {
        document.getElementById('mainContent').classList.add('hidden');
        document.getElementById('qPage1').classList.add('hidden');
        document.getElementById('qPage'+n).classList.remove('hidden');
    }

    function startFinalSequence() {
        document.getElementById('qPage2').classList.add('hidden');
        document.getElementById('finalLovePage').classList.remove('hidden');
        const delay = ms => new Promise(r => setTimeout(r, ms));
        async function run() {
            document.getElementById('dkLogoFinal').style.opacity = 1; await delay(1000);
            document.getElementById('lineL').style.width = "40%"; document.getElementById('lineR').style.width = "40%"; await delay(1000);
            document.getElementById('tagB').style.opacity = 1; document.getElementById('tagM').style.opacity = 1; await delay(1000);
            document.getElementById('lineDL').style.height = "120px"; document.getElementById('lineDR').style.height = "120px"; await delay(1000);
            document.getElementById('n16').style.opacity = 1; document.getElementById('n20').style.opacity = 1; await delay(1000);
            document.getElementById('lineML').style.width = "40%"; document.getElementById('lineMR').style.width = "40%"; await delay(1000);
            document.getElementById('d21').style.opacity = 1; await delay(1500);
            document.getElementById('finalContentArea').classList.remove('hidden');
            document.getElementById('longWish').innerText = "Deepika, as you have achieved 18th year of your life, I hope that you will be more determined to your future and will stay healthy from all the health prblms that you r facing rn, and you will climb up the ladder of success with comfort. Maybe by the 20th birthday, you'll be a bit less ziddi (just 1% less?), but you'll always be my flower. Here's to our infinite future! ğŸ§¿ğŸ§—â€â™€ï¸ğŸ’–";
        }
        run();
    }

    function createStars() {
        const container = document.getElementById('starsContainer');
        for(let i=0; i<50; i++) {
            const s = document.createElement('div'); s.className = 'star';
            s.style.width = s.style.height = Math.random()*3 + 'px';
            s.style.left = Math.random()*100 + 'vw';
            container.appendChild(s);
        }
    }

    function spawnBalloons() {
        setInterval(() => {
            const b = document.createElement('div'); b.className = 'balloon';
            b.style.left = Math.random() * 100 + 'vw';
            b.style.backgroundColor = ['#ff4e50','#ffd700','#ff9a9e','#ffffff'][Math.floor(Math.random()*4)];
            document.body.appendChild(b);
            setTimeout(() => b.remove(), 7000);
        }, 800);
    }

    function toggleLock() { document.getElementById('funnyLock').classList.toggle('hidden'); }
    function checkFunnyPass() { if(document.getElementById('funnyPass').value === "Let's Deep Dive") startSection(2); else alert("Wrong code! ğŸ¤«"); }
</script>
</body>
                                                                                                   </html>
