<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 18 â€“ Deepika â¤ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;1,700&family=Poppins:wght@300;500;700&family=Caveat:wght@700&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #ff4e50; --accent: #ffd700; --purple-bg: #2d004d; --neon: #00ffcc; }
        body { margin: 0; padding: 0; min-height: 100vh; background: linear-gradient(135deg, #ff9a9e, #fad0c4, #fbc2eb, #a18cd1); background-size: 400% 400%; animation: romanticBG 12s ease infinite; font-family: 'Poppins', sans-serif; text-align: center; color: white; overflow-x: hidden; }
        @keyframes romanticBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .hidden { display: none !important; }
        .full-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; padding: 20px; box-sizing: border-box; }
        
        #audioOverlay { background: rgba(0,0,0,0.95); z-index: 20000; cursor: pointer; }
        .glow { text-shadow: 0 0 10px #fff, 0 0 20px var(--primary); animation: pulse 2s infinite alternate; }
        @keyframes pulse { from { text-shadow: 0 0 10px #fff; } to { text-shadow: 0 0 30px var(--primary); } }

        .btn { background: white; color: var(--primary); border: none; padding: 15px 35px; border-radius: 50px; font-weight: bold; cursor: pointer; margin: 10px; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.3); font-family: 'Poppins'; }
        .btn:hover { transform: scale(1.1); background: #fff0f0; }
        input { padding: 15px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.5); text-align: center; font-family: 'Poppins'; outline: none; width: 280px; margin: 15px; background: rgba(255,255,255,0.9); color: #333; font-weight: bold; }

        #dateGate { background: radial-gradient(circle, #2c3e50 0%, #000000 100%); }
        #countdownTimer { font-size: 3em; font-family: 'Playfair Display'; color: var(--accent); margin: 20px 0; }

        .cipher-box { background: rgba(0,0,0,0.3); padding: 40px; border-radius: 30px; border: 2px solid rgba(255,255,255,0.2); backdrop-filter: blur(10px); box-shadow: 0 20px 50px rgba(0,0,0,0.3); }

        #slideshowContainer { background: radial-gradient(circle, #430000 0%, #000000 100%); z-index: 11000; }
        .slide-img { max-width: 85%; max-height: 65vh; border-radius: 20px; border: 5px solid white; box-shadow: 0 0 40px rgba(255,78,80,0.4); }
        .caption { margin-top: 30px; font-size: 2.2em; font-family: 'Caveat', cursive; color: var(--accent); text-shadow: 2px 2px 8px rgba(0,0,0,0.8); }

        /* Final Page Elements */
        #mainContent { background: var(--purple-bg); }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.5; animation: crash 2s linear infinite; }
        @keyframes crash { 0% { transform: translateY(-10vh) translateX(0); opacity: 1; } 100% { transform: translateY(110vh) translateX(10vw); opacity: 0; } }

        .message-box { background: rgba(255,255,255,0.1); backdrop-filter: blur(15px); padding: 40px; border-radius: 25px; max-width: 650px; margin: 20px auto; border: 1px solid var(--neon); line-height: 1.8; font-size: 1.2em; z-index: 2; position: relative; }
        
        .balloon { position: fixed; bottom: -120px; width: 60px; height: 85px; border-radius: 50% 50% 50% 50% / 45% 45% 55% 55%; z-index: 999; animation: floatUp 7s ease-in forwards; }
        @keyframes floatUp { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(-130vh) rotate(15deg); opacity: 0; } }

        /* ROAMING Wall of Love Sidebar */
        #loveSidebar { 
            position: fixed; 
            width: 100px;
            height: 100px;
            z-index: 1001; 
            cursor: pointer; 
            animation: roam 15s linear infinite; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        @keyframes roam {
            0% { top: 10%; left: 10%; }
            25% { top: 20%; left: 80%; }
            50% { top: 80%; left: 70%; }
            75% { top: 70%; left: 10%; }
            100% { top: 10%; left: 10%; }
        }
        .love-icon { font-size: 50px; filter: drop-shadow(0 0 15px var(--neon)); transition: 0.3s; }
        .love-icon:hover { transform: scale(1.2); }

        /* Nickname Pop Fix */
        #lovePop { 
            background: rgba(20, 0, 40, 0.95); 
            z-index: 5000; 
            overflow-y: auto; 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            align-content: center;
            padding: 80px 20px;
            max-height: 100vh;
        }
        .nickname { font-family: 'Dancing Script', cursive; font-size: 2.2em; color: var(--accent); text-shadow: 2px 2px 5px rgba(0,0,0,0.5); animation: fadeIn 0.8s forwards; opacity: 0; margin: 10px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Heart Interaction */
        #heartPulseContainer { z-index: 2; margin: 10px auto; width: 100px; height: 100px; display: flex; justify-content: center; align-items: center; position: relative; }
        .main-heart { font-size: 60px; cursor: pointer; animation: heartBeat 1.2s infinite; user-select: none; }
        @keyframes heartBeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .floating-heart { position: fixed; pointer-events: none; animation: flyUp 2s ease-out forwards; z-index: 9999; }
        @keyframes flyUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-250px) scale(2); opacity: 0; } }

        /* Question Pages Fonts */
        .q-text { font-family: 'Playfair Display', serif; font-size: 2.8em; font-weight: 700; color: white; margin-bottom: 40px; line-height: 1.2; }

        /* Final Page Animation */
        #finalDeclaration { 
            font-family: 'Playfair Display', serif; 
            font-size: 4.5em; 
            font-style: italic;
            color: var(--neon); 
            text-shadow: 0 0 30px var(--neon); 
            opacity: 0;
            transform: scale(0.5);
            animation: revealFinal 2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            animation-delay: 0.5s;
        }
        @keyframes revealFinal { to { opacity: 1; transform: scale(1); } }

        /* D & K Logo */
        .dk-logo {
            font-family: 'Playfair Display', serif;
            font-size: 3em;
            width: 150px;
            height: 150px;
            border: 3px solid var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
            box-shadow: 0 0 20px var(--accent);
            animation: pulseLogo 3s infinite;
        }
        .dk-logo::before { content: 'â¤ï¸'; position: absolute; font-size: 0.4em; bottom: 10px; }
        @keyframes pulseLogo { 0%, 100% { box-shadow: 0 0 20px var(--accent); } 50% { box-shadow: 0 0 50px var(--accent); transform: scale(1.05); } }

        #birthdayMsg { font-family: 'Dancing Script', cursive; font-size: 3em; color: var(--accent); opacity: 0; animation: fadeIn 2s forwards; animation-delay: 1.5s; }
    </style>
</head>
<body>

    <audio id="quizMusic" loop><source src="quiz.m4a" type="audio/mpeg"></audio>
    <audio id="memoriesMusic" loop><source src="memories.mp3" type="audio/mpeg"></audio>
    <audio id="finalMusic" loop><source src="final.mp3" type="audio/mpeg"></audio>

    <div id="audioOverlay" class="full-screen" onclick="startExperience()">
        <h1 class="glow" style="font-family: 'Playfair Display'; font-size: 3.5em;">Chapter 18 â¤ï¸</h1>
        <p style="font-size: 1.2em; letter-spacing: 1px;">Click to enter Deepika's World</p>
        <button class="btn">Start Magic âœ¨</button>
    </div>

    <div id="dateGate" class="full-screen hidden">
        <h2 class="glow" style="font-family: 'Playfair Display';">Good things take time, My Love... ğŸ’—</h2>
        <div id="countdownTimer">00:00:00</div>
        <button id="proceedToCipher" class="btn hidden" onclick="showCipher()">Unlock My Memories â”</button>
    </div>

    <div id="welcomeScreen" class="full-screen hidden">
        <h1 class="glow" style="font-family: 'Playfair Display'; margin-bottom: 20px;">For My Kaajukatli â¤ï¸</h1>
        <div class="cipher-box">
            <h3 style="color: var(--accent); font-family: 'Poppins';">ğŸ”“ The Chapter 18 Cipher</h3>
            <p style="letter-spacing: 4px; border: 2px dashed #fff; padding: 20px; font-size: 1.5em; background: rgba(0,0,0,0.2); border-radius: 15px; color: var(--accent);">
                23-8-15 &nbsp; 9-19 &nbsp; 25-15-21-18 <br> 19-15-21-12-13-1-20-5 ?
            </p>
            <p style="font-size: 0.85em; color: #ffd7d7; margin-top: 15px;"><i>(HINT: Answer in CAPITAL letters. No AI help! ğŸ˜‰)</i></p>
            <input type="text" id="cipherInput" placeholder="ENTER DECODED NAME...">
            <br><button class="btn" onclick="checkCipher()">Verify & Unlock âœ¨</button>
            <p id="cipherError" class="hidden" style="color: #ff8585; font-weight: bold; margin-top: 15px;">That's not it! Try again, my love. â¤ï¸</p>
        </div>
    </div>

    <div id="successScreen" class="full-screen hidden">
        <h1 class="glow" style="font-size: 4em; font-family: 'Playfair Display';">Correct! âœ…</h1>
        <p style="font-family: 'Caveat'; font-size: 1.8em; color: var(--accent);">Welcome to your 18th Chapter. â¤ï¸âœ¨</p>
    </div>

    <div id="categoryMenu" class="full-screen hidden">
        <h2 class="glow" style="font-family: 'Playfair Display'; font-size: 2.5em; margin-bottom: 40px;">Choose a Storyline âœ¨</h2>
        <button class="btn" onclick="startSection(1)">âœ¨ The Classic Beauty</button>
        <button class="btn" onclick="toggleLock()">ğŸ˜œ Little Miss Dramebaaz</button>
        <button class="btn" onclick="startSection(3)">ğŸ‘©â€â¤ï¸â€ğŸ‘¨ The Soulmate Saga</button>
        <div id="funnyLock" class="hidden">
            <input type="password" id="funnyPass" placeholder="Secret Access Code...">
            <br><button class="btn" onclick="checkFunnyPass()">Unlock Folder ğŸ”“</button>
        </div>
    </div>

    <div id="slideshowContainer" class="full-screen hidden">
        <img id="currentSlideImg" class="slide-img" src="">
        <div id="currentCaption" class="caption"></div>
        <button class="btn" onclick="nextSlide()" style="margin-top: 30px;">Next Memory â”</button>
    </div>

    <div id="navPopup" class="full-screen hidden" style="background: rgba(0,0,0,0.95);">
        <h2 class="glow" style="font-family: 'Playfair Display';">Where to next, Deepika? âœ¨</h2>
        <div id="popupOptions"></div>
    </div>

    <div id="mainContent" class="full-screen hidden">
        <div id="starsContainer"></div>
        
        <div id="loveSidebar" onclick="toggleLovePop()">
            <div class="love-icon">ğŸ’–</div>
            <p style="font-size: 0.6em; font-weight: bold; color: var(--neon); text-align: center;">CATCH ME!<br>WALL OF LOVE</p>
        </div>

        <h1 id="birthdayMsg">Happy Birthday Kaajukatli! ğŸ‚</h1>
        
        <div id="heartPulseContainer">
            <div class="main-heart" onclick="popHeart(event)">â¤ï¸</div>
        </div>
        <p style="font-family: 'Caveat'; color: var(--neon); z-index: 2; position: relative; margin-top: -10px;">(Tap the heart to feel my pulse...)</p>

        <div class="message-box">
            <span id="typing"></span>
        </div>
        
        <button id="questionBtn" class="btn hidden glow" onclick="showQuestion(1)" style="margin-top: 10px; z-index: 2; position: relative;">A Question for you... ğŸ’Œ</button>
    </div>

    <div id="lovePop" class="full-screen hidden" onclick="toggleLovePop()">
        <h2 style="width: 100%; font-family: 'Playfair Display'; color: white; margin-bottom: 20px;">Every Name for You...</h2>
    </div>

    <div id="qPage1" class="full-screen hidden" style="background: var(--purple-bg);">
        <div class="q-text">How many future years do you want to be with me? ğŸ¥º</div>
        <button class="btn" onclick="showQuestion(2)" style="font-size: 2.5em;">âˆ</button>
        <button class="btn" onclick="showQuestion(2)">INFINITE</button>
    </div>

    <div id="qPage2" class="full-screen hidden" style="background: var(--purple-bg);">
        <div class="q-text">You really do mean your answer? ğŸ§</div>
        <button class="btn" onclick="finalDeclaration()">YES! â¤ï¸</button>
        <button class="btn" onclick="alert('Khabardar ye option choose kiya toh ğŸ”ª');">NO</button>
    </div>

    <div id="finalLovePage" class="full-screen hidden" style="background: var(--purple-bg);">
        <h1 id="finalDeclaration">I LOVE YOU DEEPIKA!</h1>
        <div class="dk-logo">D & K</div>
        
        <div id="surpriseTrigger" style="margin-top: 30px;">
            <button class="btn glow" onclick="revealLastSurprise()">Tap for one last surprise âœ¨</button>
        </div>

        <div id="lastMsg" class="hidden" style="margin-top: 20px; animation: fadeIn 2s forwards;">
            <p style="font-family: 'Caveat'; font-size: 2em; color: var(--accent);">Hope you like this Surprise! Now something is waiting for you...</p>
            <a href="https://digibouquet.vercel.app/bouquet/3f6e53da-ef6d-4b64-9e1a-389729da7fe7" target="_blank" style="color: var(--neon); font-size: 1.2em; text-decoration: underline;">Click Here to See Your Special Bouquet ğŸ’</a>
            <div style="font-size: 4em; margin-top: 15px;">ğŸ˜˜ğŸ’–ğŸ’ğŸ¥°ğŸ’Œ</div>
        </div>
    </div>

<script>
    let currentSectionId = 0, currentIndex = 0;
    let visited = { 1: false, 2: false, 3: false };
    let nicknameVisited = false; // Flag for button visibility
    const quizAud = document.getElementById('quizMusic');
    const memAud = document.getElementById('memoriesMusic');
    const finAud = document.getElementById('finalMusic');

    const nicknames = ["Sweetheart", "Doraemon", "Kaajukatli", "Gulab Jamun", "Sweety", "Natkhat", "My Other Half", "My Life", "Cutie pie", "My soul", "My heartbeat", "Raajkumarii", "Meri bachii", "My Moon without smudge"];

    function startExperience() {
        quizAud.play();
        document.getElementById('audioOverlay').classList.add('hidden');
        document.getElementById('dateGate').classList.remove('hidden');
        startCountdown();
    }

    function startCountdown() {
        let time = 10; 
        const display = document.getElementById('countdownTimer');
        const interval = setInterval(() => {
            time--;
            if(time <= 0) {
                clearInterval(interval);
                display.innerText = "It's Time! â¤ï¸";
                document.getElementById('proceedToCipher').classList.remove('hidden');
            } else { display.innerText = time + "s"; }
        }, 1000);
    }

    function showCipher() {
        document.getElementById('dateGate').classList.add('hidden');
        document.getElementById('welcomeScreen').classList.remove('hidden');
    }

    function checkCipher() {
        if(document.getElementById('cipherInput').value.trim().toUpperCase() === "KARTIK") {
            let vol = 1.0;
            let fade = setInterval(() => {
                if(vol > 0.1) { vol -= 0.1; quizAud.volume = vol; }
                else { clearInterval(fade); quizAud.pause(); memAud.play(); }
            }, 100);
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('successScreen').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('successScreen').classList.add('hidden');
                document.getElementById('categoryMenu').classList.remove('hidden');
            }, 3000);
        } else { document.getElementById('cipherError').classList.remove('hidden'); }
    }

    const sections = {
        1: [{img: "Deepika1.jpg", msg: "Beginning of yours journey ğŸŒ±"}, {img: "Deepika2.jpg", msg: "My favorite smile ğŸ˜ŒğŸ’—"}, {img: "Deepika3.jpg", msg: "Just elegant âœ¨"}, {img: "Deepika4.jpg", msg: "ssshhh.... you are mine ğŸ¤«â¤ï¸"}, {img: "Deepika5.jpg", msg: "Doraemon ğŸ±â€ğŸš€"}, {img: "Deepika6.jpg", msg: "Undoubtedly, you are the most beautiful girl ğŸ‘‘"}],
        2: [{img: "Deepika7.jpg", msg: " Khooyi si  ğŸ”ğŸ’–"}, {img: "Deepika8.jpg", msg: "Kitni khush h yrr - aisi hi reh ğŸ˜ŠğŸ§¿"}, {img: "Deepika9.jpg", msg: "Gehrii sochh.... ğŸ¤”ğŸ’­"}, {img: "Deepika10.jpg", msg: "Chhota Don ğŸ˜ğŸ‘Š"}, {img: "Deepika11.jpg", msg: "In my control now.... chin tapak dum dum ğŸª„ğŸ˜ˆ"}, {img: "Deepika.jpg", msg: "My chubby princess ğŸ˜˜ğŸ’"}],
        3: [{img: "Deepika12.jpg", msg: "Holding you - just a phenomenal experience ğŸ¤ğŸ’"}, {img: "Deepika13.jpg", msg: "Looking into each other - our future ğŸ‘ï¸ğŸŒ…"}, {img: "Deepika14.jpg", msg: "An invisible bluetooth we have ğŸ“¶ğŸ’"}, {img: "Deepika15.jpg", msg: "Just you and me ğŸ‘©â€â¤ï¸â€ğŸ‘¨"}, {img: "Deepika16.jpg", msg: "The deadly duoo ğŸ”¥âš”ï¸"}, {img: "Deepika17.jpg", msg: "Made for each other â™¾ï¸ğŸŒ¹"}]
    };

    function startSection(id) {
        currentSectionId = id; currentIndex = 0; visited[id] = true;
        document.getElementById('categoryMenu').classList.add('hidden');
        document.getElementById('navPopup').classList.add('hidden');
        document.getElementById('slideshowContainer').classList.remove('hidden');
        updateSlide();
    }

    function updateSlide() {
        const data = sections[currentSectionId][currentIndex];
        document.getElementById('currentSlideImg').src = data.img;
        document.getElementById('currentCaption').innerText = data.msg;
    }

    function nextSlide() {
        currentIndex++;
        if(currentIndex < sections[currentSectionId].length) updateSlide();
        else handleSectionEnd();
    }

    function handleSectionEnd() {
        document.getElementById('slideshowContainer').classList.add('hidden');
        const popup = document.getElementById('navPopup');
        const options = document.getElementById('popupOptions');
        options.innerHTML = "";
        popup.classList.remove('hidden');
        if (!visited[1]) addOption("âœ¨ The Goddess Era", () => startSection(1));
        if (!visited[2]) addOption("ğŸ˜œ Dramebaaz", () => {
            popup.classList.add('hidden');
            document.getElementById('categoryMenu').classList.remove('hidden');
            document.getElementById('funnyLock').classList.remove('hidden');
        });
        if (!visited[3]) addOption("ğŸ‘©â€â¤ï¸â€ğŸ‘¨ Soulmate Saga", () => startSection(3));
        addOption("ğŸš€ Launch Into Chapter 18", launchHome);
    }

    function addOption(text, cb) {
        const b = document.createElement('button'); b.className = "btn"; b.innerText = text; b.onclick = cb;
        document.getElementById('popupOptions').appendChild(b);
    }

    function launchHome() {
        memAud.pause(); finAud.play();
        document.getElementById('navPopup').classList.add('hidden');
        document.getElementById('mainContent').classList.remove('hidden');
        createStars(); spawnBalloons();
        setTimeout(() => { document.getElementById('mainContent').style.opacity = "1"; typeWriter(); }, 50);
    }

    function toggleLovePop() {
        const pop = document.getElementById('lovePop');
        if(pop.classList.contains('hidden')) {
            pop.innerHTML = '<h2 style="width: 100%; font-family: \'Playfair Display\'; color: white; margin-bottom: 20px;">Every Name for You...</h2>';
            nicknames.forEach((name, i) => {
                const span = document.createElement('span');
                span.className = 'nickname';
                span.innerText = name + (i < nicknames.length - 1 ? " â€¢ " : "");
                span.style.animationDelay = (i * 0.1) + 's';
                pop.appendChild(span);
            });
            pop.classList.remove('hidden');
            
            // Logic to reveal the question button after visiting
            nicknameVisited = true;
            document.getElementById('questionBtn').classList.remove('hidden');
        } else { pop.classList.add('hidden'); }
    }

    function popHeart(e) {
        for(let i=0; i<3; i++) {
            const h = document.createElement('div');
            h.innerHTML = 'â¤ï¸';
            h.className = 'floating-heart';
            h.style.left = e.clientX + (Math.random()*40-20) + 'px';
            h.style.top = e.clientY + 'px';
            h.style.fontSize = (Math.random()*20+20)+'px';
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 2000);
        }
    }

    function createStars() {
        const container = document.getElementById('starsContainer');
        for(let i=0; i<50; i++) {
            const s = document.createElement('div');
            s.className = 'star';
            s.style.width = s.style.height = Math.random()*3 + 'px';
            s.style.left = Math.random()*100 + 'vw';
            s.style.animationDelay = Math.random()*2 + 's';
            container.appendChild(s);
        }
    }

    function spawnBalloons() {
        setInterval(() => {
            const b = document.createElement('div');
            b.className = 'balloon';
            b.style.left = Math.random() * 100 + 'vw';
            b.style.backgroundColor = ['#ff4e50','#ffd700','#ff9a9e','#ffffff'][Math.floor(Math.random()*4)];
            b.style.animationDuration = (Math.random()*3+4)+'s';
            document.body.appendChild(b);
            setTimeout(() => b.remove(), 7000);
        }, 800);
    }

    function typeWriter() {
        const text = "You are stepping into your incredible light. Happy Birthday, Soulmate! â¤ï¸";
        let i = 0;
        function type() {
            if (i < text.length) {
                document.getElementById("typing").innerHTML += text.charAt(i);
                i++; setTimeout(type, 55);
            }
        }
        type();
    }

    function showQuestion(num) {
        document.getElementById('mainContent').classList.add('hidden');
        document.getElementById('qPage1').classList.add('hidden');
        document.getElementById('qPage' + num).classList.remove('hidden');
    }

    function finalDeclaration() {
        document.getElementById('qPage2').classList.add('hidden');
        document.getElementById('finalLovePage').classList.remove('hidden');
    }

    function revealLastSurprise() {
        document.getElementById('surpriseTrigger').classList.add('hidden');
        document.getElementById('lastMsg').classList.remove('hidden');
    }

    function toggleLock() { document.getElementById('funnyLock').classList.toggle('hidden'); }
    function checkFunnyPass() {
        if(document.getElementById('funnyPass').value === "Let's Deep Dive") startSection(2);
        else alert("Ask Deepika for the secret code... ğŸ¤«â¤ï¸");
    }
</script>
</body>
    </html>
